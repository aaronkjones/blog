<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Aaron Jones">
    <meta name="description" content="Aaron Jones">
    <meta name="keywords" content="blog,developer,devops,personal">

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Home Assistant Security System"/>
<meta name="twitter:description" content="Introduction This is a high-level guide that will get you started out with Home Assistant as a basic security system.
Overview  Installing Home Assistant Configuring Z-Wave Adding Z-Wave Sensors Configuring Notifications Creating a Notification Automation Testing Notification Automation  Materials Used  Raspberry Pi 3 B&#43; $40 GoControl HUSBZB-1 Z-Wave USB Antenna $40 Ecolink Z-Wave Door/Window Sensor x 6 $35/ea Ecolink Z-Wave Garage Door Sensor $30  Total cost: $320"/>

    <meta property="og:title" content="Home Assistant Security System" />
<meta property="og:description" content="Introduction This is a high-level guide that will get you started out with Home Assistant as a basic security system.
Overview  Installing Home Assistant Configuring Z-Wave Adding Z-Wave Sensors Configuring Notifications Creating a Notification Automation Testing Notification Automation  Materials Used  Raspberry Pi 3 B&#43; $40 GoControl HUSBZB-1 Z-Wave USB Antenna $40 Ecolink Z-Wave Door/Window Sensor x 6 $35/ea Ecolink Z-Wave Garage Door Sensor $30  Total cost: $320" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://aaronkjones.com/blog/home-assistant-security-system/" /><meta property="article:published_time" content="2019-03-15T18:30:40-07:00"/>
<meta property="article:modified_time" content="2019-03-15T18:30:40-07:00"/>

    
      <base href="http://aaronkjones.com/blog/home-assistant-security-system/">
    
    <title>
  Home Assistant Security System · aaronkjones
</title>

    
      <link rel="canonical" href="http://aaronkjones.com/blog/home-assistant-security-system/">
    

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css" integrity="sha256-oSrCnRYXvHG31SBifqP2PM1uje7SJUyX0nTwO2RJV54=" crossorigin="anonymous" />

    
      
      
      <link rel="stylesheet" href="http://aaronkjones.com/css/coder.min.28d751104f30c16da1aa1bb04015cbe662cacfe0d1b01af4f2240ad58580069c.css" integrity="sha256-KNdREE8wwW2hqhuwQBXL5mLKz&#43;DRsBr08iQK1YWABpw=" crossorigin="anonymous" media="screen" />
    

    

    

    

    <link rel="icon" type="image/png" href="http://aaronkjones.com/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="http://aaronkjones.com/img/favicon-16x16.png" sizes="16x16">

    <meta name="generator" content="Hugo 0.48" />
  </head>

  <body class=" ">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="http://aaronkjones.com">
      aaronkjones
    </a>
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="http://aaronkjones.com/about/">About</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="http://aaronkjones.com/posts/">Blog</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="http://aaronkjones.com/projects/">Projects</a>
          </li>
        
      
      
    </ul>
  </section>
</nav>


      <div class="content">
        
  <section class="container page">
  <article>
    <header>
      <h1>Home Assistant Security System</h1>
    </header>

    

<h2 id="introduction">Introduction</h2>

<p>This is a high-level guide that will get you started out with Home Assistant as a basic security system.</p>

<h3 id="overview">Overview</h3>

<ul>
<li>Installing Home Assistant</li>
<li>Configuring Z-Wave</li>
<li>Adding Z-Wave Sensors</li>
<li>Configuring Notifications</li>
<li>Creating a Notification Automation</li>
<li>Testing Notification Automation</li>
</ul>

<h2 id="materials-used">Materials Used</h2>

<ul>
<li><a href="https://www.amazon.com/ELEMENT-Element14-Raspberry-Pi-Motherboard/dp/B07BDR5PDW/ref=sr_1_4?keywords=raspberry+pi&amp;qid=1552499073&amp;s=gateway&amp;sr=8-4">Raspberry Pi 3 B+</a> $40</li>
<li><a href="https://www.amazon.com/GoControl-CECOMINOD016164-HUSBZB-1-USB-Hub/dp/B01GJ826F8/ref=sr_1_5?keywords=z-wave+usb&amp;qid=1552499004&amp;s=gateway&amp;sr=8-5">GoControl HUSBZB-1 Z-Wave USB Antenna</a> $40</li>
<li><a href="https://www.amazon.com/Z-Wave-Magnets-Window-Sensor-DWZWAVE2-5-ECO/dp/B01N5HB4U5/ref=sr_1_9?keywords=ecolink&amp;qid=1552895648&amp;s=electronics&amp;sr=1-9">Ecolink Z-Wave Door/Window Sensor</a> x 6 $35/ea</li>
<li><a href="https://www.amazon.com/Z-Wave-Plated-Reliability-Garage-TILT-ZWAVE2-5-ECO/dp/B01MRZB0NT/ref=pd_lpo_vtph_60_bs_lp_t_1?_encoding=UTF8&amp;psc=1&amp;refRID=SYE35K9HVQ98S8FGM56F">Ecolink Z-Wave Garage Door Sensor</a> $30</li>
</ul>

<p>Total cost: $320</p>

<h2 id="installing-home-assistant">Installing Home Assistant</h2>

<p>To install HA, see the <a href="https://www.home-assistant.io/getting-started/">Getting Started</a> guide.</p>

<p>Also, take a look at the <a href="https://www.home-assistant.io/docs/installation/">alternative installation methods</a>.</p>

<p>Personally, I chose Hassbian because I wanted a more traditional Linux environment to work in. Hass.io makes installation very simple.</p>

<h2 id="configuring-z-wave">Configuring Z-Wave</h2>

<p><a href="https://www.home-assistant.io/docs/z-wave/">HA Z-Wave Documentation</a></p>

<p>Firstly, we will need to configure HA to enable Z-Wave devices. Configuration of HA is handled in the file, <code>/home/homeassistant/.homeassistant/configuration.yaml</code> on the Raspberry Pi. Components are enabled by including them in this file.</p>

<p>To enable Z-Wave add:</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">zwave:
  usb_path: /dev/ttyACM0
  device_config: !include zwave_device_config.yaml</code></pre></div>
<blockquote>
<p>If /dev/ttyACM0 is not the path to your Z-Wave USB device, see <a href="https://www.home-assistant.io/docs/z-wave/installation/#platform-specific-instructions">Platform specific instructions</a></p>
</blockquote>

<p>Once you add a component you must restart HA to load it.</p>

<p><code>sudo systemctl restart home-assistant@homeassistant.service</code></p>

<p>After HA has restarted, you should see &ldquo;Z-Wave&rdquo; in the configuration settings.</p>

<blockquote>
<p>If you don&rsquo;t see Z-Wave under Configuration see <a href="https://www.home-assistant.io/docs/configuration/troubleshooting/#my-component-does-not-show-up">My component does not show up</a> for troubleshooting.</p>
</blockquote>

<h2 id="adding-z-wave-sensors">Adding Z-Wave Sensors</h2>

<p><a href="https://www.home-assistant.io/docs/z-wave/adding/">Adding devices documentation</a></p>

<p>The basic workflow is:</p>

<ul>
<li>Go to Z-Wave configuration in Home Assistant</li>
<li>With the plastic tab still inserted in the sensor, or the battery removed, click the <code>Add Node</code> button</li>
<li>Bring the device close to the Z-Wave USB Antenna</li>
<li>Pull the plastic tab on the sensor to put it in inclusion mode.</li>
<li>Install the sensor on a door/window</li>
<li>Click <code>Heal Network</code> in the Z-Wave configuration</li>
</ul>

<blockquote>
<p>Full user guide <a href="https://6tlur2di0ct3xw8lx1hkhknd-wpengine.netdna-ssl.com/wp-content/uploads/DW-Zwave-Manual-R1-01.pdf">here</a></p>
</blockquote>

<p>Your device should now be visible in HA.</p>

<h2 id="configuring-notifications">Configuring Notifications</h2>

<p>There are many <a href="https://www.home-assistant.io/components/#search/notification">notification</a> components available in HA. Personally, I am using the <a href="https://www.home-assistant.io/docs/ecosystem/ios/">iOS notification</a> and <a href="https://www.home-assistant.io/components/notify.smtp/">SMTP</a>.</p>

<p>To enable a notification component, add it to the configuration file (<code>/home/homeassistant/.homeassistant/configuration.yaml</code>).</p>

<p>For example, to enable iOS notifications, simply add:</p>

<p><code>ios:</code></p>

<h2 id="creating-a-notification-automation">Creating a Notification Automation</h2>

<p>You can get creative on notification automations, but starting out I wanted to be notified if any sensor was tripped. To do so, we will need to create an automation.</p>

<h3 id="through-the-web-ui">Through the Web UI</h3>

<p>The simplest way to create an automation is to go to the <code>Automations</code> section of the configuration and select each sensor under trigger, set their state from off to on.</p>

<p><img src="https://i.imgur.com/3BQhrX5.png" alt="" /></p>

<p>For action select <code>notifiy.&lt;your device&gt;</code> and insert a JSON formatted payload.</p>

<p><img src="https://i.imgur.com/f3Ne1J7.png" alt="" /></p>

<h3 id="from-the-cli">From the CLI</h3>

<p>You can also edit the <code>/home/homeassistant/.homeassistant/automations.yaml</code> file directly.</p>

<p>Here is an example.</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">DO NOT USE THIS EXACTLY, YOUR SENSOR ENTITY_ID WILL DIFFER

- id: <span style="color:#0ff;font-weight:bold">&#39;1552497003983&#39;</span>
  alias: Door/Window Opened
  trigger:
  - entity_id: binary_sensor.ecolink_door_window_sensor_sensor
    from: <span style="color:#0ff;font-weight:bold">&#39;off&#39;</span>
    platform: state
    to: <span style="color:#0ff;font-weight:bold">&#39;on&#39;</span>
 ...


  - entity_id: binary_sensor.ecolink_garage_door_tilt_sensor_sensor
    from: <span style="color:#0ff;font-weight:bold">&#39;off&#39;</span>
    platform: state
    to: <span style="color:#0ff;font-weight:bold">&#39;on&#39;</span>
  condition: []
  action:
  - data:
      message: A door or window was opened
      title: Alert
    service: notify.ios_chosin</code></pre></div>
<h2 id="testing-notification-automation">Testing Notification Automation</h2>

<p>In order to ensure the alert will function properly, we can invoke a test scenario.</p>

<p>To do so, go to the <code>Services</code> configuration of HA.</p>

<p><img src="https://i.imgur.com/8RD5NXE.png" alt="Services" /></p>

<p>Once there, in the Service field start typing <code>notify</code> and you will see the different notification options.</p>

<blockquote>
<p>If you don&rsquo;t see any, then the notifiy component did not load correctly (did you restart HA after loading it?).</p>
</blockquote>

<p>In the <code>Service Data</code> field, enter:</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4">{
&#34;title&#34;:&#34;Test&#34;,
&#34;message&#34;:&#34;Test message&#34;
}</pre></div>
<p>You should have something like this:</p>

<p><img src="https://i.imgur.com/RxLb7A9.png" alt="" /></p>

<p>When you press <code>Call Service</code>, you should receive a notification on your iPhone or however you configured to be notified.</p>

<p>Now in order to make sure the automation tigger will notify you, we can do another test.</p>

<ul>
<li>Go to the <code>States</code> section.</li>
</ul>

<p><img src="https://i.imgur.com/oP0CbUw.png" alt="States" /></p>

<p>Select a sensor to use for testing and set state to off.</p>

<p>Once you click <code>Set State</code>, the automation should trigger, and you should receive a notification</p>

<p><img src="https://i.imgur.com/aArax1Bl.jpg" alt="" /></p>

<p>Once you&rsquo;ve finished testing and are comfortable with the automation triggering successfully, you may want to edit the automation and add a condition that only triggers an alert when you are away.</p>

<p><img src="https://i.imgur.com/I9GJoh5.png" alt="" /></p>

<p>Read more about device trackers <a href="https://www.home-assistant.io/components/device_tracker/">here</a></p>

<h2 id="conclusion">Conclusion</h2>

<p>You should now have a basic home security system. This, coupled with some motion detecting cameras (I use Amcrest UltraHD 2K&rsquo;s with Blue Iris software), can be a cost-effective home secruity solution.</p>

<p>To take this further, you could do like I did and add a dashboard display with sensor status and a pinpad to enable/disable the alarm.</p>

<p><img src="https://i.imgur.com/iABCVUX.jpg" alt="" /></p>

<p>I may make a part 2 with steps to replicate that.</p>

<p>Need help? Hit me up on twitter or email.</p>

  </article>
</section>


      </div>

      <footer class="footer">
  <section class="container">
    
     © 2019
    
    
  </section>
</footer>

    </main>

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-114562131-1', 'auto');
	
	ga('send', 'pageview');
}
</script>


  </body>

</html>
